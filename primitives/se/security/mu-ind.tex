%!TEX root = ../se.tex

\heading{Indistinguishability Security.}
We extend Rogaway's definition of  indistinguishability security for authenticated encryption~\cite{CCS:Rogaway02}, which is in the single-user setting, to the multi-user setting. The formalization is based on game $\gmuIND{\SE}(\advA)$ of \figref{fig-se-mu-ind}, associated to encryption scheme $\SE$ and adversary $\advA$. The game initially samples a random challenge bit $b$, with $b=1$ indicating it is in ``real'' mode and $b=0$ that it is in ``ideal" mode. As per our conventions noted in \secref{sec-defs},  the sets $V,W$ are assumed initialized to the empty set, and the integer $v$ is assumed initialized to $0$. Now the adversary $\advA$ has access to an oracle $\NewO$ that creates new user instances. $\advA$ also has access to an encryption oracle $\EncO$ that takes a user instance identifier $i$, a nonce $\iv \in \NS{\SE}$, a message $\msg$, and a header $\header$. The oracle either returns a uniformly random bit string of length $\cl{\SE}$ that depends only on the length of $\msg$ (for $b=0$), or an encryption under $\Enc{\SE}$ using the key of user $i$  (for $b=1$). The oracle checks that $\advA$ does not re-use nonces for a user instance, and that it is invoked only for user instances that exist. Analogously, there is a verification oracle $\VfO$ that takes user instance $i$, nonce $\iv \in \NS{\SE}$, ciphertext $\ciph$, and header $\header$. Oracle $\VfO$ always accepts ciphertexts generated by $\EncO$ for the same  $i$, $\iv$, and $\header$, rejects all other ciphertexts for $b=0$, and uses the decryption algorithm $\Dec{\SE}$ to check the validity of the ciphertext for $b=1$.  As a last step, the adversary outputs a bit $b'$ that can be viewed as a guess for $b$.  The advantage of adversary $\advA$ in breaking the mu-ind security of   $\SE$ is defined as $\muindAdv{\SE}{\advA} = 2\Pr[\gmuIND{\SE}(\advA)]- 1$.

One can further strengthen the security of the above ind definition by considering \emph{nonce-misuse resistance} as defined by Rogaway and Shrimpton~\cite{EC:RogShr06}. This requires changing the condition $(i,\iv)\in U$ in oracle $\EncO$ to only prevent queries where nonce \emph{and} message (or even nonce, message, and header) are repeated. 

Rogaway's definition of indistinguishability security for authenticated encryption (in the su setting)~\cite{CCS:Rogaway02} gives the adversary a decryption oracle, while we give it a verification oracle. The latter is simpler and our definition can be shown equivalent to one with a decryption oracle by the technique of BN~\cite{AC:BelNam00}.

\begin{figure} [t]
\twoCols{0.45}{0.45}{
\gameName{$\gmuIND{\SE}(\advA)$} 
% $U,V\gets\emptyset$ covered by conventions
$b \getsr \bits$ ;
$b' \getsr \advA^{\NewO,\EncO,\VfO}$\\
Return $(b' = b)$ \medskip

\underline{$\NewO()$} \\[2pt]
$v\gets v+1$ ; $\nkey[v] \getsr\bits^{\kl{\SE}}$ \medskip

\underline{$\EncO(i,\iv,\msg,\header)$}\\[2pt]
If not ($1\leq i\leq v$) then return $\bot$ \\
If ($(i,\iv)\in V$) then return $\bot$ \\
$\ciph_1\gets \Enc{\SE}(\nkey[i],\iv,\msg,\header)$\\
$\ciph_0\getsr\bits^{\cl{\SE}(|\msg|)}$ \\
$V\gets V\cup\{(v,\iv)\}$ ; $W \gets W \cup \{ (i,\iv,\ciph_b,\header) \}$ \\
Return $\ciph_b$
}
{
\underline{$\VfO(i,\iv,\ciph,\header)$}\\[2pt]
If not ($1\leq i\leq v$) then return $\bot$ \\
If ($(i,\iv,\ciph,\header) \in W$) then return $\true$ \\ 
If ($b=0$) then return $\false$ \\
$\msg \gets \Dec{\SE}(\nkey[i],\iv,\ciph,\header)$ \\
Return ($\msg\neq\bot)$ \medskip


}
\vspace{-2ex}
\caption{Game defining multi-user indistinguishability security of symmetric encryption scheme $\SE$.}
\label{fig-se-mu-ind}
\hrulefill
\end{figure}

